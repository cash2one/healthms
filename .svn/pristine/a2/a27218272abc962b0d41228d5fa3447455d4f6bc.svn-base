$(document).ready(function(){$(".healthms-login-container").css("margin-top",($(window).height()-163)*0.15);$("#patientEmail").blur(function(){if($("#patientEmail").val()==""){$("#patientEmail").parent().addClass("has-error has-feedback");$("#patientEmail").after('<span class="healthms-login-error-patient-email glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span id="inputError2Status" class="healthms-login-error-patient-email sr-only">(error)</span>')}else{$("#patientEmail").parent().removeClass("has-error has-feedback");$(".healthms-login-error-patient-email").remove()}});$("#patientPassword").blur(function(){if($("#patientPassword").val()==""){$("#patientPassword").parent().addClass("has-error has-feedback");$("#patientPassword").after('<span class="healthms-login-error-patient-password glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span id="inputError2Status" class="healthms-login-error-patient-password sr-only">(error)</span>')}else{$("#patientPassword").parent().removeClass("has-error has-feedback");$(".healthms-login-error-patient-password").remove()}});$("#doctorEmail").blur(function(){if($("#doctorEmail").val()==""){$("#doctorEmail").parent().addClass("has-error has-feedback");$("#doctorEmail").after('<span class="healthms-login-error-doctor-email glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span id="inputError2Status" class="healthms-login-error-doctor-email sr-only">(error)</span>')}else{$("#doctorEmail").parent().removeClass("has-error has-feedback");$(".healthms-login-error-doctor-email").remove()}});$("#doctorPassword").blur(function(){if($("#doctorPassword").val()==""){$("#doctorPassword").parent().addClass("has-error has-feedback");$("#doctorPassword").after('<span class="healthms-login-error-doctor-password glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span id="inputError2Status" class="healthms-login-error-doctor-password sr-only">(error)</span>')}else{$("#doctorPassword").parent().removeClass("has-error has-feedback");$(".healthms-login-error-doctor-password").remove()}})});function ajaxLoginForm(typ){$.ajax({type:"POST",url:$SCRIPT_ROOT,dataType:"json",data:{"type":typ,"patientEmail":$("#patientEmail").val(),"patientPassword":$("#patientPassword").val(),"doctorEmail":$("#doctorEmail").val(),"doctorPassword":$("#doctorPassword").val()},error:function(XMLHttpRequest,textStatus,errorThrown){alert(XMLHttpRequest.status);alert(XMLHttpRequest.readyState);alert(textStatus)},success:function(data,textStatus){if(data.typ=="patient"){if(data.result=="emailError"){$("#patientEmail").focus();$("#patientEmail").parent().addClass("has-error has-feedback");$("#patientEmail").after('<span class="healthms-login-error-patient-email glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span id="inputError2Status" class="healthms-login-error-patient-email sr-only">(error)</span>')}else{if(data.result=="pwdError"){$("#patientPassword").focus();$("#patientPassword").parent().addClass("has-error has-feedback");$("#patientPassword").after('<span class="healthms-login-error-patient-password glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span id="inputError2Status" class="healthms-login-error-patient-password sr-only">(error)</span>')}}}else{if(data.typ=="doctor"){if(data.result=="emailError"){$("#doctorEmail").focus();$("#doctorEmail").parent().addClass("has-error has-feedback");$("#doctorEmail").after('<span class="healthms-login-error-doctor-email glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span id="inputError2Status" class="healthms-login-error-doctor-email sr-only">(error)</span>')}else{if(data.result=="pwdError"){$("#doctorPassword").focus();$("#doctorPassword").parent().addClass("has-error has-feedback");$("#doctorPassword").after('<span class="healthms-login-error-doctor-password glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span id="inputError2Status" class="healthms-login-error-doctor-password sr-only">(error)</span>')}}}}}});return false}$(document).ready(function(){var patientNationSelect=$("#patientRegNation");patientNationSelect.append('<option value="">请选择</option>');for(var i=0;i<nationItems.length;i++){var nation=nationItems[i];var name=nation.name;patientNationSelect.append('<option value="'+name+'">'+name+"</option>")}$("#patientRegBirthday").datetimepicker({lang:"ch",timepicker:false,format:"d/m/Y"});$("#patientRegEmail").blur(function(){var result="true";if($("#patientRegEmail").val()==""){result="电子邮箱不能为空"}else{if(!checkEmail($("#patientRegEmail").val())){result="电子邮箱格式不正确"}}if(result!="true"){$("#patientRegEmail").parent().addClass("has-error has-feedback");$("#patientRegEmail").after('<span class="healthms-patient-reg-email-err glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span class="healthms-patient-reg-email-err sr-only">(error)</span>');
$("#patientRegEmailEMsg").html(result)}else{$("#patientRegEmail").parent().removeClass("has-error has-feedback");$(".healthms-patient-reg-email-err").remove();$("#patientRegEmailEMsg").html("")}});$("#patientRegPassword").blur(function(){var result="true";if($("#patientRegPassword").val()==""){result="密码不能为空"}else{if(!checkPwdLength($("#patientRegPassword").val())){result="密码长度为6-20位字符"}}if(result!="true"){$("#patientRegPassword").parent().addClass("has-error has-feedback");$("#patientRegPassword").after('<span class="healthms-patient-reg-pwd-err glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span class="healthms-patient-reg-pwd-err sr-only">(error)</span>');$("#patientRegPasswordEMsg").html(result)}else{$("#patientRegPassword").parent().removeClass("has-error has-feedback");$(".healthms-patient-reg-pwd-err").remove();$("#patientRegPasswordEMsg").html("")}});$("#patientRegPasswordCon").blur(function(){var result="true";if($("#patientRegPasswordCon").val()==""){result="密码不能为空"}else{if(!checkPwdEqual($("#patientRegPassword").val(),$("#patientRegPasswordCon").val())){result="两次输入密码不一致"}}if(result!="true"){$("#patientRegPasswordCon").parent().addClass("has-error has-feedback");$("#patientRegPasswordCon").after('<span class="healthms-patient-reg-pwdcon-err glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span class="healthms-patient-reg-pwdcon-err sr-only">(error)</span>');$("#patientRegPasswordConEMsg").html(result)}else{$("#patientRegPasswordCon").parent().removeClass("has-error has-feedback");$(".healthms-patient-reg-pwdcon-err").remove();$("#patientRegPasswordConEMsg").html("")}});$("#patientRegName").blur(function(){if($("#patientRegName").val()==""){$("#patientRegName").parent().addClass("has-error has-feedback");$("#patientRegName").after('<span class="healthms-patient-reg-name-err glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span class="healthms-patient-reg-name-err sr-only">(error)</span>');$("#patientRegNameEMsg").removeClass("hidden");$("#patientRegNameEMsg").addClass("show")}else{$("#patientRegName").parent().removeClass("has-error has-feedback");$(".healthms-patient-reg-name-err").remove();$("#patientRegNameEMsg").removeClass("show");$("#patientRegNameEMsg").addClass("hidden")}});$("#patientRegBirthday").blur(function(){if($("#patientRegBirthday").val()==""){$("#patientRegBirthday").parent().addClass("has-error has-feedback");$("#patientRegBirthday").after('<span class="healthms-patient-reg-birthday-err glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span class="healthms-patient-reg-birthday-err sr-only">(error)</span>');$("#patientRegBirthdayEMsg").removeClass("hidden");$("#patientRegBirthdayEMsg").addClass("show")}else{$("#patientRegBirthday").parent().removeClass("has-error has-feedback");$(".healthms-patient-reg-birthday-err").remove();$("#patientRegBirthdayEMsg").removeClass("show");$("#patientRegBirthdayEMsg").addClass("hidden")}});$("#patientRegNation").blur(function(){if($("#patientRegNation").val()==""){$("#patientRegNationEMsg").removeClass("hidden");$("#patientRegNationEMsg").addClass("show")}else{$("#patientRegNationEMsg").removeClass("show");$("#patientRegNationEMsg").addClass("hidden")}});$("#patientRegProvince").blur(function(){if($("#patientRegCounty").hasClass("hidden")){if(($("#patientRegProvince").val()=="")||($("#patientRegCity").val()=="")||($("#patientRegCity").val()=="请选择")){$("#patientRegProvinceEMsg").removeClass("hidden");$("#patientRegProvinceEMsg").addClass("show")}else{$("#patientRegProvinceEMsg").removeClass("show");$("#patientRegProvinceEMsg").addClass("hidden")}}else{if(($("#patientRegProvince").val()=="")||($("#patientRegCity").val()=="")||($("#patientRegCity").val()=="请选择")||($("#patientRegCounty").val()=="")||($("#patientRegCounty").val()=="请选择")){$("#patientRegProvinceEMsg").removeClass("hidden");$("#patientRegProvinceEMsg").addClass("show")}else{$("#patientRegProvinceEMsg").removeClass("show");$("#patientRegProvinceEMsg").addClass("hidden")}}});$("#patientRegCity").blur(function(){if($("#patientRegCounty").hasClass("hidden")){if($("#patientRegCity").val()==""||$("#patientRegCity").val()=="请选择"){$("#patientRegProvinceEMsg").removeClass("hidden");$("#patientRegProvinceEMsg").addClass("show")}else{$("#patientRegProvinceEMsg").removeClass("show");$("#patientRegProvinceEMsg").addClass("hidden")}}else{if(($("#patientRegCity").val()=="")||($("#patientRegCity").val()=="请选择")||($("#patientRegCounty").val()=="")||($("#patientRegCounty").val()=="请选择")){$("#patientRegProvinceEMsg").removeClass("hidden");$("#patientRegProvinceEMsg").addClass("show")}else{$("#patientRegProvinceEMsg").removeClass("show");$("#patientRegProvinceEMsg").addClass("hidden")}}});$("#patientRegCounty").blur(function(){if($("#patientRegCounty").val()==""||$("#patientRegCounty").val()=="请选择"){$("#patientRegProvinceEMsg").removeClass("hidden");$("#patientRegProvinceEMsg").addClass("show")}else{$("#patientRegProvinceEMsg").removeClass("show");
$("#patientRegProvinceEMsg").addClass("hidden")}});$("#patientRegProfession").blur(function(){if($("#patientRegProfession").val()==""){$("#patientRegProfession").parent().addClass("has-error has-feedback");$("#patientRegProfession").after('<span class="healthms-patient-reg-profession-err glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span class="healthms-patient-reg-profession-err sr-only">(error)</span>');$("#patientRegProfessionEMsg").removeClass("hidden");$("#patientRegProfessionEMsg").addClass("show")}else{$("#patientRegProfession").parent().removeClass("has-error has-feedback");$(".healthms-patient-reg-profession-err").remove();$("#patientRegProfessionEMsg").removeClass("show");$("#patientRegProfessionEMsg").addClass("hidden")}});$("#patientRegAddress").blur(function(){if($("#patientRegAddress").val()==""){$("#patientRegAddress").parent().addClass("has-error has-feedback");$("#patientRegAddress").after('<span class="healthms-patient-reg-address-err glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span class="healthms-patient-reg-address-err sr-only">(error)</span>');$("#patientRegAddressEMsg").removeClass("hidden");$("#patientRegAddressEMsg").addClass("show")}else{$("#patientRegAddress").parent().removeClass("has-error has-feedback");$(".healthms-patient-reg-address-err").remove();$("#patientRegAddressEMsg").removeClass("show");$("#patientRegAddressEMsg").addClass("hidden")}});$("#patientRegTel").blur(function(){var result="true";if($("#patientRegTel").val()==""){result="电话不能为空"}else{if(!checkTel($("#patientRegTel").val())){result="电话格式不正确"}}if(result!="true"){$("#patientRegTel").parent().addClass("has-error has-feedback");$("#patientRegTel").after('<span class="healthms-patient-reg-tel-err glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span class="healthms-patient-reg-tel-err sr-only">(error)</span>');$("#patientRegTelEMsg").html(result)}else{$("#patientRegTel").parent().removeClass("has-error has-feedback");$(".healthms-patient-reg-tel-err").remove();$("#patientRegTelEMsg").html("")}});$("#patientRegCode").blur(function(){if($("#patientRegCode").val()==""){$("#patientRegCode").parent().addClass("has-error has-feedback");$("#patientRegCode").after('<span class="healthms-patient-reg-code-err glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span><span class="healthms-patient-reg-code-err sr-only">(error)</span>');$("#patientRegCodeEMsg").removeClass("hidden");$("#patientRegCodeEMsg").addClass("show")}else{$("#patientRegCode").parent().removeClass("has-error has-feedback");$(".healthms-patient-reg-code-err").remove();$("#patientRegCodeEMsg").removeClass("show");$("#patientRegCodeEMsg").addClass("hidden")}});$("#patientRegReset").click(function(){$("#patientRegSubmit").attr("disabled","disabled")})});function loadCity(){var provinceName=$("#patientRegProvince option:selected").val();$("#patientRegCounty").empty();$("#patientRegCounty").html("<option value=''>请选择</option>");for(var i=0;i<chinaItems.length;i++){var provinceItem=chinaItems[i];if(provinceItem.name==provinceName){var cityItems=provinceItem.sub;var cityHtml="";if(provinceItem.type==0){$("#patientRegCounty").addClass("hidden");$("#patientRegCity").removeAttr("onclick","loadCounty();")}else{$("#patientRegCounty").removeClass("hidden");$("#patientRegCity").attr("onclick","loadCounty('"+JSON.stringify(cityItems)+"');")}for(var i=0;i<cityItems.length;i++){var cityItem=cityItems[i];cityHtml+="<option value='"+cityItem.name+"'>"+cityItem.name+"</option>"}$("#patientRegCity").html(cityHtml);break}}}function loadCounty(cityItemsStr){var cityName=$("#patientRegCity option:selected").val();var cityItems=JSON.parse(cityItemsStr);for(var i=0;i<cityItems.length;i++){var cityItem=cityItems[i];if(cityItem.name==cityName){var countyItems=cityItem.sub;var countyHtml="";if(cityItem.name=="其他"){$("#patientRegCounty").addClass("hidden")}else{$("#patientRegCounty").removeClass("hidden");if(countyItems.length==0&&cityItem.name!="请选择"){countyHtml+="<option value=''>请选择</option><option value='其他'>其他</option>"}else{if(cityItem.name=="请选择"){countyHtml+="<option value=''>请选择</option>"}else{for(var i=0;i<countyItems.length;i++){var countyItem=countyItems[i];countyHtml+="<option value='"+countyItem.name+"'>"+countyItem.name+"</option>"}}}}$("#patientRegCounty").html(countyHtml);break}}}function checkProtocol(){if($("#patientRegProt").is(":checked")){$("#patientRegSubmit").removeAttr("disabled")}else{$("#patientRegSubmit").attr("disabled","disabled")}}function checkEmail(email){if(email.match(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/)){return true}return false}function checkPwdLength(pwd){if(6<=pwd.length&&20>=pwd.length){return true}return false}function checkPwdEqual(pwd,pwdCon){if(pwd==pwdCon){return true}return false}function checkTel(tel){if(tel.match(/^(?:13\d|15\d|18\d)\d{5}(\d{3}|\*{3})$/)||tel.match(/^((0\d{2,3})-)?(\d{7,8})(-(\d{3,}))?$/)){return true
}return false}function changeCode(){var url="/code/"+Math.random();$("#patientRegCodeImg").attr("src",url);return false};